# –û—Ç—á—ë—Ç –æ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ

**–î–∞—Ç–∞:** 2025-12-21

---

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #1: –î–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–§–∞–π–ª—ã:** `app-main.js:150`, `groups-ui.js:190`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
```javascript
// app-main.js —Å—Ç—Ä–æ–∫–∞ 150
const config = await ConfigAPI.getConfig();  // ‚Üê –ü–ï–†–í–´–ô –∑–∞–ø—Ä–æ—Å

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ playerSelections, loopModes, volumes
// ...

await loadPlayerGroups();  // ‚Üê –í—ã–∑–æ–≤ groups-ui.js

// groups-ui.js —Å—Ç—Ä–æ–∫–∞ 190
const config = await ConfigAPI.getConfig();  // ‚Üê –í–¢–û–†–û–ô –∑–∞–ø—Ä–æ—Å (–¢–û–¢ –ñ–ï!)
```

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
1. `getConfig()` - –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ `/api/config`
2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ settings –≤ appState
3. `loadPlayerGroups()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `getConfig()` **–ï–©–Å –†–ê–ó**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è **–î–í–ê–ñ–î–´** –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å—Ç–∞—Ä—Ç–µ
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–π HTTP –∑–∞–ø—Ä–æ—Å
- `loadPlayerGroups()` –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç `appState.playerGroups`, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ –º–æ–≥–ª–∞ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞

**–í–æ–ø—Ä–æ—Å—ã:**
1. –ü–æ—á–µ–º—É `loadPlayerGroups()` –¥–µ–ª–∞–µ—Ç —Å–≤–æ–π –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å?
2. –ù–µ –¥–æ–ª–∂–Ω–∞ –ª–∏ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π `config`?
3. –ú–æ–∂–µ—Ç –ª–∏ –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É—Ç—å –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ, —á–µ–º –ø–µ—Ä–≤—ã–π?

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `config.playerGroups` –≤ `loadPlayerGroups()` –≤–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

```javascript
// app-main.js
const config = await ConfigAPI.getConfig();
// ... –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ ...
await loadPlayerGroups(config.playerGroups);  // ‚Üê –ø–µ—Ä–µ–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ

// groups-ui.js
export async function loadPlayerGroups(playerGroups) {
  if (playerGroups) {
    appState.setPlayerGroups(playerGroups);
  } else {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã
    const config = await ConfigAPI.getConfig();
    appState.setPlayerGroups(config.playerGroups);
  }
  renderPlayerGroups();
}
```

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≥—Ä–æ–º–∫–æ—Å—Ç–∏

**–§–∞–π–ª:** `player-service.js`

**–ï—Å—Ç—å –î–í–ï —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏:**

#### –§—É–Ω–∫—Ü–∏—è #1: `setVolume()` (—Å—Ç—Ä–æ–∫–∏ 144-151)
```javascript
export async function setVolume(playerId, volume) {
  try {
    await PlayersAPI.setVolume(playerId, volume);
    appState.setPlayerVolume(playerId, volume);
    // ‚ùå –ù–ï–¢ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä!
  } catch (error) {
    addMessage(`–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏: ${error.message}`, 'error');
  }
}
```

#### –§—É–Ω–∫—Ü–∏—è #2: `setPlayerVolume()` (—Å—Ç—Ä–æ–∫–∏ 265-279)
```javascript
export async function setPlayerVolume(playerId, volume) {
  if (appState.isDemoModeEnabled()) {
    appState.setPlayerVolume(playerId, volume);
    // ... –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI ...
    return;
  }

  try {
    await PlayersAPI.setVolume(playerId, volume);
    appState.setPlayerVolume(playerId, volume);
    ConfigSync.saveVolumes(); // ‚úÖ –ï–°–¢–¨ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ!
    // ... –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI ...
  } catch (error) {
    addMessage(`–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏: ${error.message}`, 'error');
  }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `setVolume()` **–ù–ï** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≥—Ä–æ–º–∫–æ—Å—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- `setPlayerVolume()` **–°–û–•–†–ê–ù–Ø–ï–¢** –≥—Ä–æ–º–∫–æ—Å—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `setPlayerVolume()` (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- –ù–æ `setVolume()` —Ç–æ–∂–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω–∞

**–í–æ–ø—Ä–æ—Å—ã:**
1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏?
2. –î–æ–ª–∂–Ω–∞ –ª–∏ `setVolume()` —Ç–æ–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å?
3. –ï—Å—Ç—å –ª–∏ –º–µ—Å—Ç–∞ –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `setVolume()` –≤–º–µ—Å—Ç–æ `setPlayerVolume()`?

**–ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `setVolume()`:**

```bash
grep -r "setVolume(" public/js --include="*.js" | grep -v "setPlayerVolume"
```

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
- –£–¥–∞–ª–∏—Ç—å `setVolume()` –∫–∞–∫ –∏–∑–±—ã—Ç–æ—á–Ω—É—é
- –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `setPlayerVolume()`
- –ò–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `setVolume()` ‚Üí `setVolumeWithoutSaving()` –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #3: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –æ–¥–Ω–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É

**–§–∞–π–ª:** `groups-ui.js:133-143`

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≥—Ä—É–ø–ø—ã:**
```javascript
await Promise.all(
  playersWithFiles.map(async playerId => {
    const fileUrl = appState.getPlayerSelection(playerId);
    const loopMode = appState.getPlayerLoopMode(playerId) || 2;

    // –ó–∞–ø—Ä–æ—Å #1: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ loop mode
    await window.PlayersAPI.setLoopMode(playerId, loopMode);
    // –ó–∞–ø—Ä–æ—Å #2: –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    return window.PlayersAPI.playMedia(playerId, fileUrl);
  })
);
```

**–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–ª–µ–µ—Ä–∞:**
- 2 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–∞ (setLoopMode ‚Üí playMedia)

**–î–ª—è 5 –ø–ª–µ–µ—Ä–æ–≤ –≤ –≥—Ä—É–ø–ø–µ:**
- 10 HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**

**–í–æ–ø—Ä–æ—Å—ã:**
1. WiiM —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –º–æ–≥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º?
2. –ú–æ–∂–µ—Ç –ª–∏ `playMedia` –Ω–∞—á–∞—Ç—å—Å—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `setLoopMode`?
3. –ù–µ –ª—É—á—à–µ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏?

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤ `player-service.js:92-100` (playAll):**
```javascript
const results = await Promise.allSettled(
  playersWithSelection.map(async player => {
    const fileUrl = appState.getPlayerSelection(player.id);
    const loopMode = appState.getPlayerLoopMode(player.id) || 2;
    await PlayersAPI.setLoopMode(player.id, loopMode);  // ‚Üê –ó–∞–ø—Ä–æ—Å #1
    return PlayersAPI.playMedia(player.id, fileUrl);    // ‚Üê –ó–∞–ø—Ä–æ—Å #2
  })
);
```

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–µ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```javascript
for (const player of playersWithFiles) {
  await window.PlayersAPI.setLoopMode(player.id, loopMode);
  await delay(100); // 100ms –∑–∞–¥–µ—Ä–∂–∫–∞
  await window.PlayersAPI.playMedia(player.id, fileUrl);
}
```

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #4: Loop Mode –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ–≥–¥–∞ = 2

**–§–∞–π–ª—ã:** `player-service.js:96`, `player-service.js:202`, `groups-ui.js:136`

**–í–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
```javascript
const loopMode = appState.getPlayerLoopMode(playerId) || 2;
```

**–ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:**
- –ï—Å–ª–∏ loop mode –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ appState ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `2` (repeat all)
- **–í–°–ï–ì–î–ê** –≤–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–í–æ–ø—Ä–æ—Å—ã:**
1. –≠—Ç–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ?
2. –ù–µ –¥–æ–ª–∂–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–Ω–æ –≤–∫–ª—é—á–∞—Ç—å loop mode?
3. –ß—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ç—Ä–µ–∫ –æ–¥–∏–Ω —Ä–∞–∑?

**–†–µ–∂–∏–º—ã WiiM:**
- `0` = no loop (–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ–¥–∏–Ω —Ä–∞–∑)
- `1` = single loop (–ø–æ–≤—Ç–æ—Ä –æ–¥–Ω–æ–≥–æ —Ç—Ä–µ–∫–∞)
- `2` = repeat all (–ø–æ–≤—Ç–æ—Ä –≤—Å–µ—Ö)
- `-1` = shuffle (—Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```javascript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ë–ï–ó –ø–æ–≤—Ç–æ—Ä–∞
const loopMode = appState.getPlayerLoopMode(playerId) ?? 0;

// –í–∞—Ä–∏–∞–Ω—Ç 2: —è–≤–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
if (appState.getPlayerLoopMode(playerId) === undefined) {
  appState.setPlayerLoopMode(playerId, 0);  // –ò–ª–∏ —Å–ø—Ä–æ—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
}
```

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #5: refreshAllPlayers –ø–æ—Å–ª–µ –ö–ê–ñ–î–û–ô –æ–ø–µ—Ä–∞—Ü–∏–∏

**–§–∞–π–ª—ã:** `player-service.js`

**–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `refreshAllPlayers()`:**

```javascript
// playAll() ‚Üí —Å—Ç—Ä–æ–∫–∞ 106
await refreshAllPlayers();

// stopAll() ‚Üí —Å—Ç—Ä–æ–∫–∞ 68
await refreshAllPlayers();

// playPlayer() ‚Üí —Å—Ç—Ä–æ–∫–∞ 211
await refreshAllPlayers();

// stopPlayer() ‚Üí —Å—Ç—Ä–æ–∫–∞ 240
await refreshAllPlayers();
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `refreshAllPlayers()`:**
```javascript
const statuses = await Promise.allSettled(
  players.map(async (player) => {
    const status = await PlayersAPI.getPlayerStatus(player.id);
    return { playerId: player.id, status };
  })
);
```

**–î–ª—è 5 –ø–ª–µ–µ—Ä–æ–≤:**
- –ö–∞–∂–¥—ã–π `refreshAllPlayers()` –¥–µ–ª–∞–µ—Ç **5 HTTP –∑–∞–ø—Ä–æ—Å–æ–≤** –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Å–ª–µ `playAll()` ‚Üí 10 –∑–∞–ø—Ä–æ—Å–æ–≤ (5√ó setLoopMode + 5√ó playMedia) + **5 –∑–∞–ø—Ä–æ—Å–æ–≤ refresh**
- –ò—Ç–æ–≥–æ: **15 –∑–∞–ø—Ä–æ—Å–æ–≤** –¥–ª—è –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏

**–í–æ–ø—Ä–æ—Å—ã:**
1. –ù—É–∂–Ω–æ –ª–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –í–°–ï –ø–ª–µ–µ—Ä—ã –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –æ–¥–Ω–∏–º?
2. –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–π –ø–ª–µ–µ—Ä?
3. Adaptive refresh (–∫–∞–∂–¥—ã–µ 2 —Å–µ–∫) –≤—Å—ë —Ä–∞–≤–Ω–æ –æ–±–Ω–æ–≤–∏—Ç —Å—Ç–∞—Ç—É—Å—ã - –º–æ–∂–µ—Ç –Ω–µ –Ω—É–∂–µ–Ω –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π refresh?

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```javascript
// –í–º–µ—Å—Ç–æ
await refreshAllPlayers();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
await refreshPlayer(playerId);  // –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–ª–µ–µ—Ä

// –ò–ª–∏ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ adaptive refresh (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫)
```

---

### ‚ùì –ü–†–û–ë–õ–ï–ú–ê #6: –î–µ–º–æ-—Ä–µ–∂–∏–º –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö

**–§–∞–π–ª:** `player-service.js`

**–§—É–Ω–∫—Ü–∏–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞:**
- ‚úÖ `playPlayer()` - –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Å—Ç—Ä–æ–∫–∞ 181)
- ‚úÖ `stopPlayer()` - –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Å—Ç—Ä–æ–∫–∞ 223)
- ‚úÖ `setPlayerVolume()` - –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Å—Ç—Ä–æ–∫–∞ 267)

**–§—É–Ω–∫—Ü–∏–∏ –ë–ï–ó –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞:**
- ‚ùå `playAll()` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå `stopAll()` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå `playMediaOnAllPlayers()` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå `setVolume()` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå `setLoopMode()` - –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

**–í–æ–ø—Ä–æ—Å:**
–î–æ–ª–∂–Ω—ã –ª–∏ `playAll()` –∏ `stopAll()` –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–µ–º–æ-—Ä–µ–∂–∏–º?

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ —Å–µ–π—á–∞—Å:**
- `playAll()` –≤—ã–∑—ã–≤–∞–µ—Ç API –¥–∞–∂–µ –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã (`playMedia()`) –ø—Ä–æ–≤–µ—Ä—è—Ç –¥–µ–º–æ-—Ä–µ–∂–∏–º
- –ù–æ –±—É–¥—É—Ç –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –Ω–∞—á–∞–ª–æ –≤—Å–µ—Ö "bulk" –æ–ø–µ—Ä–∞—Ü–∏–π:

```javascript
export async function playAll() {
  if (appState.isDemoModeEnabled()) {
    const players = appState.getPlayers();
    players.forEach(player => {
      if (appState.getPlayerSelection(player.id)) {
        const status = appState.getPlayerStatus(player.id) || {};
        status.status = 'play';
        appState.setPlayerStatus(player.id, status);
      }
    });
    window.renderMultiPlayers?.();
    addMessage('[–î–ï–ú–û] –í—Å–µ –ø–ª–µ–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã', 'info');
    return;
  }

  // ... –æ–±—ã—á–Ω–∞—è –ª–æ–≥–∏–∫–∞
}
```

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #7: config-sync.service.js –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–§–∞–π–ª:** `public/js/services/config-sync.service.js`

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 24-34):**
```javascript
saveSelectionsTimer = setTimeout(async () => {
  try {
    const selections = appState.getAllPlayerSelections();
    await ConfigAPI.syncConfig({
      playerSelections: selections
    });
    console.log('[CONFIG-SYNC] Player selections saved');
  } catch (error) {
    console.error('[CONFIG-SYNC] Error saving player selections:', error);
    // ‚ùå –û–®–ò–ë–ö–ê –¢–û–õ–¨–ö–û –í –ö–û–ù–°–û–õ–¨, –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ù–ï –£–ó–ù–ê–ï–¢!
  }
}, 300);
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å - —Ç–æ–ª—å–∫–æ `console.error()`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ù–ï —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å
- –ú–æ–∂–µ—Ç –¥—É–º–∞—Ç—å —á—Ç–æ –≤—Å—ë —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ, –∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ

**–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ:**
- `saveLoopModes()` - —Å—Ç—Ä–æ–∫–∞ 54
- `saveVolumes()` - —Å—Ç—Ä–æ–∫–∞ 78
- `savePlayerGroups()` - —Å—Ç—Ä–æ–∫–∞ 99

**–í–æ–ø—Ä–æ—Å:**
–î–æ–ª–∂–Ω—ã –ª–∏ –º—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è?

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```javascript
} catch (error) {
  console.error('[CONFIG-SYNC] Error saving player selections:', error);
  addMessage('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏', 'error');
}
```

---

### ‚ùì –ü–†–û–ë–õ–ï–ú–ê #8: AppState –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç playerGroups –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–§–∞–π–ª—ã:** `AppState.js`, `groups-ui.js`

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥—Ä—É–ø–ø—ã (`groups-ui.js:32-59`):**
```javascript
export async function createPlayerGroup() {
  // ... –ø—Ä–æ–≤–µ—Ä–∫–∏ ...

  const groups = appState.getPlayerGroups();
  groups.push(newGroup);
  appState.setPlayerGroups(groups);

  await ConfigSync.savePlayerGroups();  // ‚Üê –Ø–≤–Ω—ã–π –≤—ã–∑–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

  renderPlayerGroups();
  clearPlayerSelection();
}
```

**–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –≥—Ä—É–ø–ø—ã (`groups-ui.js:89-107`):**
```javascript
export async function deletePlayerGroup(groupId) {
  // ... –ø—Ä–æ–≤–µ—Ä–∫–∏ ...

  const groups = appState.getPlayerGroups();
  const filtered = groups.filter(g => g.id !== groupId);
  appState.setPlayerGroups(filtered);

  await ConfigSync.savePlayerGroups();  // ‚Üê –Ø–≤–Ω—ã–π –≤—ã–∑–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

  renderPlayerGroups();
}
```

**–°—Ä–∞–≤–Ω–∏—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:**
- `setPlayerSelection()` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ debounce
- `setPlayerVolume()` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `ConfigSync.saveVolumes()`
- `setPlayerLoopMode()` ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `ConfigSync.saveLoopModes()`

**–ù–û:**
- `setPlayerGroups()` ‚Üí **–ù–ï–¢** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–í–æ–ø—Ä–æ—Å:**
–ü–æ—á–µ–º—É –≥—Ä—É–ø–ø—ã —Ç—Ä–µ–±—É—é—Ç —è–≤–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ `savePlayerGroups()`, –∞ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?

**–ù–µ –ª–æ–≥–∏—á–Ω–µ–µ –ª–∏:**
```javascript
// AppState.js
setPlayerGroups(groups) {
  this.playerGroups = groups;
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ –¥–µ–º–æ-—Ä–µ–∂–∏–º)
  if (!this.isDemoMode && window.ConfigSync) {
    window.ConfigSync.savePlayerGroups();
  }
}
```

---

## üìã –°–í–û–î–ö–ê –í–û–ü–†–û–°–û–í –ö –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ

### –í–æ–ø—Ä–æ—Å 1: –î–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** `getConfig()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
**–í–æ–ø—Ä–æ—Å:** –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —á–µ–≥–æ-—Ç–æ –∏–ª–∏ –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å?

### –í–æ–ø—Ä–æ—Å 2: –î–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** `setVolume()` –∏ `setPlayerVolume()` –¥–µ–ª–∞—é—Ç –ø–æ—á—Ç–∏ —Ç–æ –∂–µ —Å–∞–º–æ–µ.
**–í–æ–ø—Ä–æ—Å:** –ó–∞—á–µ–º –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏? –î–æ–ª–∂–Ω–∞ –ª–∏ `setVolume()` —Ç–æ–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å?

### –í–æ–ø—Ä–æ—Å 3: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≥—Ä—É–ø–ø—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** 5 –ø–ª–µ–µ—Ä–æ–≤ = 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤.
**–í–æ–ø—Ä–æ—Å:** WiiM —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å —ç—Ç–∏–º? –ù—É–∂–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞?

### –í–æ–ø—Ä–æ—Å 4: Loop Mode –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
**–ü—Ä–æ–±–ª–µ–º–∞:** `|| 2` –æ–∑–Ω–∞—á–∞–µ—Ç –≤—Å–µ–≥–¥–∞ —Ä–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞.
**–í–æ–ø—Ä–æ—Å:** –≠—Ç–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ? –ù–µ –¥–æ–ª–∂–µ–Ω –ª–∏ –±—ã—Ç—å `|| 0` (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–∞)?

### –í–æ–ø—Ä–æ—Å 5: refresh –ø–æ—Å–ª–µ –ö–ê–ñ–î–û–ô –æ–ø–µ—Ä–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ `playAll()` –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –í–°–ï –ø–ª–µ–µ—Ä—ã.
**–í–æ–ø—Ä–æ—Å:** –ù—É–∂–µ–Ω –ª–∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π refresh –µ—Å–ª–∏ adaptive —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫?

### –í–æ–ø—Ä–æ—Å 6: –î–µ–º–æ-—Ä–µ–∂–∏–º –Ω–µ –≤–µ–∑–¥–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
**–ü—Ä–æ–±–ª–µ–º–∞:** `playAll()` –∏ `stopAll()` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –¥–µ–º–æ-—Ä–µ–∂–∏–º.
**–í–æ–ø—Ä–æ—Å:** –î–æ–ª–∂–Ω—ã –ª–∏ bulk-–æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–º–µ—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞?

### –í–æ–ø—Ä–æ—Å 7: –û—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ –≤–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ `syncConfig()` –ø–∞–¥–∞–µ—Ç - —Ç–æ–ª—å–∫–æ console.error.
**–í–æ–ø—Ä–æ—Å:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è?

### –í–æ–ø—Ä–æ—Å 8: –ì—Ä—É–ø–ø—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
**–ü—Ä–æ–±–ª–µ–º–∞:** `setPlayerGroups()` —Ç—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ–≥–æ `savePlayerGroups()`.
**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∫ —É playerSelections?

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### üî¥ –í—ã—Å–æ–∫–∏–π (–≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É):
1. **–ü—Ä–æ–±–ª–µ–º–∞ #7** - –æ—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–∑–∞–º–µ—Ç–Ω—ã
2. **–ü—Ä–æ–±–ª–µ–º–∞ #4** - loop mode –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω

### üü° –°—Ä–µ–¥–Ω–∏–π (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å):
3. **–ü—Ä–æ–±–ª–µ–º–∞ #1** - –¥–≤–æ–π–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ config
4. **–ü—Ä–æ–±–ª–µ–º–∞ #5** - –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ refresh
5. **–ü—Ä–æ–±–ª–µ–º–∞ #3** - –º–Ω–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### üü¢ –ù–∏–∑–∫–∏–π (–∫–æ–¥-—Å—Ç–∞–π–ª):
6. **–ü—Ä–æ–±–ª–µ–º–∞ #2** - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
7. **–ü—Ä–æ–±–ª–µ–º–∞ #6** - –¥–µ–º–æ-—Ä–µ–∂–∏–º –Ω–µ –≤–µ–∑–¥–µ
8. **–ü—Ä–æ–±–ª–µ–º–∞ #8** - –Ω–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å API

---

*–û—Ç—á—ë—Ç —Å–æ–∑–¥–∞–Ω: 2025-12-21*
