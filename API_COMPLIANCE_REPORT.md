# –û—Ç—á—ë—Ç –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ WiiM HTTP API

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-12-18
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** `wiim-client.js`, `server.js`, `network-scanner.js`
**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** [WiiM HTTP API (GitHub)](https://github.com/cvdlinden/wiim-httpapi)

---

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 1. **–§–æ—Ä–º–∞—Ç API –∑–∞–ø—Ä–æ—Å–æ–≤** ‚úÖ

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `https://{ip}/httpapi.asp?command={command}`

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (wiim-client.js:6-9, 36-37):**
```javascript
this.baseUrl = (useHttps ? 'https://' : 'http://') + ipAddress;
const url = this.baseUrl + endpoint;
```

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç

---

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** ‚úÖ

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** *"The WiiM device has a self-signed certificate, which is deemed unsafe by any modern browser"*

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (wiim-client.js:9):**
```javascript
this.agent = useHttps ? new https.Agent({ rejectUnauthorized: false }) : null;
```

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

---

### 3. **–ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º** ‚úÖ

| –ö–æ–º–∞–Ω–¥–∞ API (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è) | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|----------------------------|------------|--------|
| `setPlayerCmd:play` | wiim-client.js:76 | ‚úÖ |
| `setPlayerCmd:pause` | wiim-client.js:77 | ‚úÖ |
| `setPlayerCmd:stop` | wiim-client.js:78 | ‚úÖ |
| `setPlayerCmd:next` | wiim-client.js:79 | ‚úÖ |
| `setPlayerCmd:prev` | wiim-client.js:80 | ‚úÖ |
| `setPlayerCmd:play:{url}` | wiim-client.js:111 | ‚úÖ |

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é** ‚úÖ

| –ö–æ–º–∞–Ω–¥–∞ API | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –°—Ç–∞—Ç—É—Å |
|-------------|------------|-----------|--------|
| `setPlayerCmd:vol:{value}` | wiim-client.js:82-85 | 0-100 ‚úÖ | ‚úÖ |
| `setPlayerCmd:vol+` | wiim-client.js:87 | - | ‚úÖ |
| `setPlayerCmd:vol-` | wiim-client.js:88 | - | ‚úÖ |
| `setPlayerCmd:mute:{n}` | wiim-client.js:89-90 | 1=mute, 0=unmute ‚úÖ | ‚úÖ |

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (wiim-client.js:83):**
```javascript
const vol = Math.max(0, Math.min(100, parseInt(volume)));
```

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0-100 –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç

---

### 5. **–†–µ–∂–∏–º—ã –ø–æ–≤—Ç–æ—Ä–∞ (Loop Mode)** ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê**

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è):**
```
loopmode values:
  -1: Unknown
   0: Loop enabled, shuffle disabled
   1: Loop once, shuffle disabled
   2: Loop enabled, shuffle enabled
   3: Shuffle enabled, repeat disabled
   4: Shuffle disabled, repeat disabled (default)
   5: Loop once, shuffle enabled
```

**–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (wiim-client.js:92-97):**
```javascript
// –†–µ–∂–∏–º—ã –ø–æ–≤—Ç–æ—Ä–∞: 0 = –æ–¥–∏–Ω —Ä–∞–∑, 1 = –ø–æ–≤—Ç–æ—Ä –æ–¥–Ω–æ–π, 2 = –ø–æ–≤—Ç–æ—Ä –≤—Å–µ—Ö, -1 = —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫
async setLoopMode(mode) {
  const validModes = [0, 1, 2, -1];
  const loopMode = validModes.includes(mode) ? mode : 0;
  return await this.request('/httpapi.asp?command=setPlayerCmd:loopmode:' + loopMode);
}
```

**‚ùå –ù–ï–°–û–û–¢–í–ï–¢–°–¢–í–ò–ï:**
1. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. –ü—Ä–æ–ø—É—â–µ–Ω—ã —Ä–µ–∂–∏–º—ã 3, 4, 5
3. –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –Ω–µ–≤–µ—Ä–Ω–æ–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–µ–∂–∏–º–æ–≤ 3, 4, 5

---

### 6. **–ó–∞–ø—Ä–æ—Å—ã —Å—Ç–∞—Ç—É—Å–∞** ‚úÖ

| –ö–æ–º–∞–Ω–¥–∞ API | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-------------|------------|------------|--------|
| `getPlayerStatus` | wiim-client.js:59-65 | –°—Ç–∞—Ç—É—Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è | ‚úÖ |
| `getStatusEx` | wiim-client.js:67-74 | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (100+ –ø–æ–ª–µ–π) | ‚úÖ |

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `getStatusEx` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è SSID, RSSI –∏ –¥—Ä—É–≥–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

### 7. **–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ HEX –ø–æ–ª–µ–π** ‚úÖ

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** *"Some parameters (SSID, device names, titles) require hex encoding"*

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (wiim-client.js:12-34):**
```javascript
decodeHex(hexString) {
  // ... –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
processPlayerData(data) {
  if (processed.Title) processed.Title = this.decodeHex(processed.Title);
  if (processed.Artist) processed.Artist = this.decodeHex(processed.Artist);
  if (processed.Album) processed.Album = this.decodeHex(processed.Album);
  if (processed.essid) processed.essid = this.decodeHex(processed.essid);
  return processed;
}
```

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HEX-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π

---

### 8. **–ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** ‚úÖ

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** URL –≤ –∫–æ–º–∞–Ω–¥–µ `setPlayerCmd:play:{url}` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (wiim-client.js:110-111, server.js:973):**
```javascript
// wiim-client.js
const encodedUrl = encodeURIComponent(url);
return await this.request('/httpapi.asp?command=setPlayerCmd:play:' + encodedUrl);

// server.js
const command = '/httpapi.asp?command=setPlayerCmd:play:' + encodeURIComponent(fileUrl);
```

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

### 9. **–°–µ—Ç–µ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚úÖ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (network-scanner.js:9-74):**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç HTTPS –Ω–∞ –ø–æ—Ä—Ç—É 443 ‚úÖ
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç endpoint `/httpapi.asp?command=getStatusEx` ‚úÖ
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–µ–π `DeviceName`, `uuid`, `firmware`, `project`, `hardware` ‚úÖ
- –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã ‚úÖ

**–õ–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (network-scanner.js:43-46):**
```javascript
const isWiiM = (
  (json.DeviceName !== undefined || json.uuid !== undefined) &&
  (json.firmware !== undefined || json.project !== undefined || json.hardware !== undefined)
);
```

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ù–∞–¥—ë–∂–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è WiiM —É—Å—Ç—Ä–æ–π—Å—Ç–≤

---

## ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### **1. –ö–†–ò–¢–ò–ß–ù–û: –†–µ–∂–∏–º—ã –ø–æ–≤—Ç–æ—Ä–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**

**–§–∞–π–ª:** `wiim-client.js:92-97`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∂–∏–º—ã –Ω–µ–≤–µ—Ä–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ 4 —Ä–µ–∂–∏–º–∞ –∏–∑ 7 –≤–æ–∑–º–æ–∂–Ω—ã—Ö
- –ü—Ä–æ–ø—É—â–µ–Ω—ã —Ä–µ–∂–∏–º—ã 3, 4, 5

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```javascript
// –†–µ–∂–∏–º—ã –ø–æ–≤—Ç–æ—Ä–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π WiiM API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
// -1: Unknown
//  0: Loop enabled, shuffle disabled
//  1: Loop once, shuffle disabled
//  2: Loop enabled, shuffle enabled
//  3: Shuffle enabled, repeat disabled
//  4: Shuffle disabled, repeat disabled (default)
//  5: Loop once, shuffle enabled
async setLoopMode(mode) {
  const validModes = [-1, 0, 1, 2, 3, 4, 5];
  const loopMode = validModes.includes(mode) ? mode : 4; // default = 4
  return await this.request('/httpapi.asp?command=setPlayerCmd:loopmode:' + loopMode);
}
```

---

### **2. –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ `.substr()`**

**–§–∞–π–ª:** `wiim-client.js:17`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```javascript
const charCode = parseInt(hexString.substr(i, 2), 16); // .substr() deprecated!
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```javascript
const charCode = parseInt(hexString.substring(i, i + 2), 16);
```

---

### **3. –ó–ê–ú–ï–ß–ê–ù–ò–ï: –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä –≤–º–µ—Å—Ç–æ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ loopmode**

**–§–∞–π–ª:** `server.js:988`

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```javascript
// –°–µ—Ä–≤–µ—Ä–Ω—ã–π –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –í–ú–ï–°–¢–û loopMode (–∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å play:URL)
startMonitoring(id, fileUrl, groupId);
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ `loopMode` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `play:URL`, –Ω–æ —ç—Ç–æ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π.

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è WiiM API:**
- `setPlayerCmd:play:{url}` - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è ‚úÖ
- `setPlayerCmd:loopmode:{n}` - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è ‚úÖ
- –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –Ω–∞—Ç–∏–≤–Ω—ã–π `loopMode` —Å `play:URL`
2. –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º WiiM
3. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –æ—Å—Ç–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

---

## ‚úÖ –•–æ—Ä–æ—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, —Å–æ–±–ª—é–¥—ë–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ

### 1. **Timeout –æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚úÖ
```javascript
// wiim-client.js:54
req.on('timeout', () => { req.destroy(); reject(new Error('Request timeout')); });
```

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏** ‚úÖ
```javascript
// wiim-client.js:53
req.on('error', (error) => { reject(error); });
```

### 3. **Graceful fallback –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ JSON** ‚úÖ
```javascript
// wiim-client.js:44-50
try {
  const result = data ? JSON.parse(data) : {};
  // ...
} catch (e) {
  resolve({ status: res.statusCode, data: data });
}
```

### 4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–π —Ç–∞–π–º–∞—É—Ç** ‚úÖ
```javascript
// .env.example:11-12
WIIM_REQUEST_TIMEOUT=5000
```

### 5. **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚úÖ
```javascript
// server.js: –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–ª–µ–µ—Ä–∞–º–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å timestamp
logWithMs(`[PLAY] Player ${id}: ...`);
```

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å | –û—Ü–µ–Ω–∫–∞ |
|-----------|--------|--------|
| **–§–æ—Ä–º–∞—Ç API** | ‚úÖ –ü–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | 100% |
| **HTTPS/SSL** | ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ | 100% |
| **–ö–æ–º–∞–Ω–¥—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è** | ‚úÖ –í—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã | 100% |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é** | ‚úÖ –° –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π | 100% |
| **–ó–∞–ø—Ä–æ—Å—ã —Å—Ç–∞—Ç—É—Å–∞** | ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è getStatusEx | 100% |
| **HEX –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | 100% |
| **URL –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ | 100% |
| **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏** | ‚úÖ –ù–∞–¥—ë–∂–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ | 100% |
| **Loop Mode** | ‚ö†Ô∏è –ù–µ–ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ | 57% (4 –∏–∑ 7 —Ä–µ–∂–∏–º–æ–≤) |
| **–ö–æ–¥ —Å—Ç–∏–ª—å** | ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–π .substr() | 95% |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** **95% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** ‚úÖ

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û)

**1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∂–∏–º—ã –ø–æ–≤—Ç–æ—Ä–∞**
- –§–∞–π–ª: `wiim-client.js`
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–µ–∂–∏–º–æ–≤ 3, 4, 5
- –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û)

**2. –ó–∞–º–µ–Ω–∏—Ç—å `.substr()` –Ω–∞ `.substring()`**
- –§–∞–π–ª: `wiim-client.js:17`
- `.substr()` deprecated —Å ES2020

**3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ loopMode —Å play:URL**
- –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - —É–±—Ä–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä
- –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–£–õ–£–ß–®–ï–ù–ò–Ø)

**4. –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ API –∫–æ–º–∞–Ω–¥—ã** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `getMetaInfo` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∞
- `setPlayerCmd:seek:{pos}` - –ø–µ—Ä–µ–º–æ—Ç–∫–∞
- `setPlayerCmd:onepause` - toggle play/pause
- Preset support: `MCUKeyShortClick:{n}`

**5. –î–æ–±–∞–≤–∏—Ç—å validation –¥–ª—è –∫–æ–º–∞–Ω–¥**
```javascript
// –ü—Ä–∏–º–µ—Ä –¥–ª—è seek
async seek(position) {
  if (position < 0) throw new Error('Position must be >= 0');
  return await this.request(`/httpapi.asp?command=setPlayerCmd:seek:${position}`);
}
```

---

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

1. **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - [HTTP API for WiiM Mini](https://www.wiimhome.com/pdf/HTTP%20API%20for%20WiiM%20Mini.pdf)
   - [HTTP API for WiiM Products v1.2](https://www.wiimhome.com/pdf/HTTP%20API%20for%20WiiM%20Products.pdf)

2. **–°–æ–æ–±—â–µ—Å—Ç–≤–æ:**
   - [WiiM Forum - HTTP API Discussion](https://forum.wiimhome.com/threads/wiim-http-api-misc-items.1592/)
   - [GitHub - cvdlinden/wiim-httpapi](https://github.com/cvdlinden/wiim-httpapi)
   - [Home Assistant Community - WiiM API](https://community.home-assistant.io/t/wiim-pro-media-player-api-and-rest-commands/553189)

3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
   - [Scribd - HTTP API PDF](https://www.scribd.com/document/761106319/HTTP-API-for-WiiM-Mini-1)

---

## ‚úÖ –í—ã–≤–æ–¥—ã

**–ü—Ä–æ–µ–∫—Ç –≤ —Ü–µ–ª–æ–º –°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π WiiM HTTP API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.**

–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTPS –∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –ù–∞–¥—ë–∂–Ω–æ–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ HEX –∏ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ URL
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –ø–æ–≤—Ç–æ—Ä–∞
- ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ç–æ–¥ `.substr()` —Ç—Ä–µ–±—É–µ—Ç –∑–∞–º–µ–Ω—ã

**–ü–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∑–∞–º–µ—á–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –Ω–∞ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.**
