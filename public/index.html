<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WiiM Control Center</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="main-layout">
        <div class="container">
            <header>
                <h1>WiiM Control Center</h1>
                <div class="header-controls">
                    <button id="view-mode-toggle" class="btn btn-secondary" onclick="toggleViewMode()">
                        <span id="view-mode-icon">üîß</span> <span id="view-mode-text">–ü—Ä–æ—Å—Ç–æ–π —Ä–µ–∂–∏–º</span>
                    </button>
                    <button id="enable-demo-btn" class="btn btn-demo" onclick="enableDemoMode(); startDemoAnimation()">üé≠ –î–µ–º–æ-—Ä–µ–∂–∏–º</button>
                    <button id="disable-demo-btn" class="btn btn-demo-exit" onclick="disableDemoMode()" style="display:none">‚úï –í—ã–π—Ç–∏ –∏–∑ –¥–µ–º–æ</button>
                    <div id="connection-status" class="status offline">‚óè</div>
                </div>
            </header>

            <!-- –¢–∞–±—ã -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('player')">–ü–ª–µ–µ—Ä</button>
                <button class="tab" onclick="switchTab('players')">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</button>
                <button class="tab" onclick="switchTab('media')">–ú–µ–¥–∏–∞</button>
                <button class="tab" onclick="switchTab('diagnostics')">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</button>
                <button class="tab" onclick="switchTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ü–ª–µ–µ—Ä -->
        <div id="tab-player" class="tab-content active">
            <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="global-controls">
                <button class="btn btn-success" onclick="playAll()">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                <button class="btn btn-danger" onclick="stopAll()">‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ</button>
                <button class="btn btn-primary" onclick="refreshAllPlayers()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã</button>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å Loop Mode (—Ç–æ–ª—å–∫–æ –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ) -->
            <div class="loop-mode-panel advanced-only" style="display:none;">
                <h3>üîÅ –†–µ–∂–∏–º –ø–æ–≤—Ç–æ—Ä–∞ —Ç—Ä–µ–∫–æ–≤</h3>
                <div class="loop-mode-description">
                    <p><strong>WiiM Native Loop</strong> - —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–∞–º–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ç—Ä–µ–∫–∏. –ù–∞–¥—ë–∂–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞.</p>
                </div>
                <div class="loop-mode-controls">
                    <button id="native-loop-btn" class="btn btn-secondary" onclick="toggleNativeLoop()">
                        üîÅ Native Loop: OFF
                    </button>
                    <span class="loop-mode-hint">–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–ª–µ–µ—Ä–∞–º</span>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏ -->
            <div class="group-management">
                <h3>üìÅ –ì—Ä—É–ø–ø—ã –ø–ª–µ–µ—Ä–æ–≤</h3>
                <div class="group-actions">
                    <button class="btn btn-success" onclick="createPlayerGroup()" id="create-group-btn" disabled>‚úì –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É</button>
                    <button class="btn btn-secondary" onclick="clearPlayerSelection()" id="clear-selection-btn" style="display:none">‚úï –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</button>
                </div>
                <div id="player-groups-list" class="player-groups-list">
                    <p class="empty-state">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø. –í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–µ–µ—Ä—ã –≥–∞–ª–æ—á–∫–∞–º–∏ –∏ —Å–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É.</p>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –ø–ª–µ–µ—Ä–æ–≤ —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º -->
            <h3>üéµ –í—Å–µ –ø–ª–µ–µ—Ä—ã</h3>
            <div id="multi-players-list" class="multi-players-list">
                <p class="empty-state">–ù–µ—Ç –ø–ª–µ–µ—Ä–æ–≤. –î–æ–±–∞–≤—å—Ç–µ –ø–ª–µ–µ—Ä—ã –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞".</p>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ -->
        <div id="tab-players" class="tab-content">
            <div class="section-header">
                <h2>–ú–æ–∏ –ø–ª–µ–µ—Ä—ã</h2>
                <div>
                    <button class="btn btn-primary" onclick="scanPlayers()">üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç—å</button>
                    <button class="btn btn-secondary" onclick="showAddPlayer()">+ –î–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é</button>
                    <button class="btn btn-warning" onclick="cleanupBrokenStates()" title="–£–¥–∞–ª–∏—Ç—å –±–∏—Ç—ã–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏">üßπ –û—á–∏—Å—Ç–∏—Ç—å –±–∏—Ç—ã–µ</button>
                </div>
            </div>

            <div id="add-player-form" class="add-form" style="display:none;">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–ª–µ–µ—Ä</h3>
                <input type="text" id="player-ip" placeholder="IP –∞–¥—Ä–µ—Å (192.168.1.xxx)">
                <input type="text" id="player-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (–æ–ø—Ü.)">
                <div>
                    <button class="btn btn-primary" onclick="addPlayerManual()">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button class="btn btn-secondary" onclick="hideAddPlayer()">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>

            <div id="players-list" class="players-list">
                <p class="empty-state">–ù–µ—Ç –ø–ª–µ–µ—Ä–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫–∞–Ω–µ—Ä –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é.</p>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ú–µ–¥–∏–∞ -->
        <div id="tab-media" class="tab-content">
            <div class="section-header">
                <h2>–ú–µ–¥–∏–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞</h2>
                <button class="btn btn-primary" onclick="document.getElementById('file-upload').click()">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
                <input type="file" id="file-upload" accept="audio/*" style="display:none" onchange="uploadFile(this.files[0])">
            </div>

            <div id="media-list" class="media-list">
                <p class="empty-state">–ù–µ—Ç —Ñ–∞–π–ª–æ–≤. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª—ã.</p>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ -->
        <div id="tab-diagnostics" class="tab-content">
            <div class="section-header">
                <h2>üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞</h2>
                <button class="btn btn-secondary" onclick="refreshDiagnostics()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>

            <div id="diagnostics-list" class="diagnostics-list">
                <p class="empty-state">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</p>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="tab-settings" class="tab-content">
            <div class="section-header">
                <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
            </div>

            <!-- –°–µ–∫—Ü–∏—è: –ü–∏—â–∞–ª–∫–∞ -->
            <div class="settings-section">
                <h3>üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∏—â–∞–ª–∫–∏</h3>
                <p class="settings-description">
                    –í—ã–±–µ—Ä–∏—Ç–µ –∑–≤—É–∫–æ–≤–æ–π —Ñ–∞–π–ª –∏–∑ –º–µ–¥–∏–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–∏—â–∞–ª–∫–∞" –Ω–∞ –ø–ª–µ–µ—Ä–∞—Ö.
                    –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–µ—Ä—ã –ø–æ –∑–≤—É–∫—É.
                </p>

                <div class="settings-row">
                    <div class="settings-item">
                        <label for="beep-sound-select">
                            <strong>–ó–≤—É–∫ –ø–∏—â–∞–ª–∫–∏</strong>
                            <span class="settings-help">–í—ã–±–µ—Ä–∏—Ç–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</span>
                        </label>
                        <div class="settings-control">
                            <select id="beep-sound-select" class="beep-sound-select" onchange="saveSettings()">
                                <option value="default">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é (Google TTS "–ë–∏–ø")</option>
                            </select>
                        </div>
                        <div class="settings-hint">
                            –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "üîî –ü–∏—â–∞–ª–∫–∞" —É –ª—é–±–æ–≥–æ –ø–ª–µ–µ—Ä–∞.
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="settings-section">
                <h3>‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">–í–µ—Ä—Å–∏—è:</span>
                        <span class="info-value">3.4</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</span>
                        <span class="info-value">3000 –º—Å (3 —Å–µ–∫—É–Ω–¥—ã)</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ü–ª–µ–µ—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ:</span>
                        <span class="info-value" id="info-players-count">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">–ú–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤:</span>
                        <span class="info-value" id="info-media-count">-</span>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <div class="messages-panel" id="messages-panel">
            <div class="resize-handle" id="resize-handle"></div>
            <div class="messages-header">
                <h2>üìù –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</h2>
            </div>

            <div class="system-messages" id="system-messages">
                <div class="message-item">–û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...</div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div id="scan-modal" class="modal">
        <div class="modal-content">
            <h3>üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏</h3>
            <div id="scan-progress">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <p id="scan-status">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é...</p>
            </div>
            <div id="scan-results" style="display:none;">
                <h4>–ù–∞–π–¥–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</h4>
                <div id="scan-results-list"></div>
            </div>
            <div class="modal-actions">
                <button id="scan-close-btn" class="btn btn-secondary" onclick="closeScanModal()" disabled>–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/app-main.js"></script>
</body>
</html>